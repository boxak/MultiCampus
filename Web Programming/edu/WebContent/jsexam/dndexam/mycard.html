<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Drag and Drop</title>
  <link rel="stylesheet" href="dragdrop.css">
  <style>
	img {
	width:150px;
	height:150px;
}
	h1{
	font-size:3em;
	} 
	button{
	width:150px;
	height:50px;
	}	
  </style>  
  
  
</head>
<body>
	<h1>HTML5로 카드 만들기</h1>
	<button onclick="save();">저장하기</button>
	<button onclick="restore();">불러오기</button>
	<button onclick="initialize();">삭제하기</button>
	<br>	
	<h2>배경 칼라 설정: <input type="color" id="bcolor" onchange="fillRect();"> 테두리 칼라 설정:<input type="color" id="lcolor"></h2>
	<h2>메세지 칼라 설정:<input type="color" id="mcolor"> 입력 메시지:<input type="text" id="textInput" onkeyup="textPush();"></h2>
  	<section id="dropbox">
 	<canvas id="canvas" width="500" height="300" onclick="fillRect();"></canvas>
  	</section>
  	<!-- 
  	<section id="picturesbox" >
    <img id="image1" src="image/1.png">
    <img id="image2" src="image/2.png">
    <img id="image3" src="image/3.png">
    <img id="image4" src="image/4.png">
    <img id="image5" src="image/5.png">
    <img id="image6" src="image/6.png">
    <img id="image7" src="image/7.png">
    <img id="image8" src="image/8.png"> 
    <img id="image9" src="image/9.png">
    <img id="image10" src="image/10.png">
    
  </section>  -->
  
  <script> 
  
 
  var can = document.getElementById('canvas');
  var context = can.getContext('2d');
  var temp;
/*   var a =document.getElementById("bcolor");
	 context.fillStyle = a; 
	 context.fillRect(0,0,500,300);
  */
 function fillRect(){
	 var a =document.getElementById("bcolor").value;
	 console.log(a);
	 context.fillStyle = a; 
	 context.fillRect(0,0,500,300);
  }
  
  
  
  
/*   저장하기, 불러오기, 삭제하기 */
  function save() {
	  
		alert(can.toDataURL());
		localStorage.setItem('canvas',can.toDataURL());
	}

	function restore() {
		var img = new Image();
		img.src = localStorage.getItem('canvas');
		img.onload = function() {
			context.drawImage(img, 0, 0);
		} 
	}
	function initialize() {
		canvas.clearRect(0, 0, 500, 300);
	} 	

	
/*  이미지 드롭 */
  var canvas, drop;
    function initiate(){
	  var images=document.querySelectorAll('#picturesbox > img');
	  for(var i=0; i<images.length; i++){
	    images[i].addEventListener('dragstart', dragged, false);
	    images[i].addEventListener('dragend', ending, false);
	  }
	  drop=document.getElementById('canvas');
	  canvas=drop.getContext('2d');
	  drop.addEventListener('dragover', function(e){ e.preventDefault(); }, false);
	  drop.addEventListener('drop', dropped, false);
	}
	function ending(e){
	  elem=e.target;	  
	}
	function dragged(e){
	  var elem=e.target;
	  e.dataTransfer.setData('aa', elem.getAttribute('id'));
	  e.dataTransfer.setDragImage(e.target, 0, 0);	
	}
	function dropped(e){		
	  e.preventDefault(); 
	  var id=e.dataTransfer.getData('aa');	 
	  var elem=document.getElementById(id);

	  var posx=e.pageX-drop.offsetLeft;
	  var posy=e.pageY-drop.offsetTop;
	  canvas.drawImage(elem,posx,posy);
	 
	}
	
	function textPush(){
		var input = document.getElementById("textInput").value;
		document.getElementById("canvas").textContent=input;
		temp=input;
		console.log(input);
	}
	
	
	window.addEventListener('load', initiate, false);
  </script>
</body>
</html>